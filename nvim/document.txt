" ==================== File Templates ====================
"             File: ultisnips_custom.vim - Custom UltiSnips settings
"       Maintainer: Gustavo Castro
" Oririnal Creator: Noah Frederick
"        Reference: https://noahfrederick.com/log/vim-templates-with-ultisnips-and-projectionist
"      Last Change: jan 04, 2022 - 17:18
"      Place it at: after/plugin/ultisnips_custom.vim

" We need python or python3 to run ultisnips
if !has("python") && !has("python3")
	finish
endif

" This function is called by the autocommand at the end of the file
function! TestAndLoadSkel() abort
	let filename = expand('%')
	" Abort on non-empty buffer or extant file
	if !(line('$') == 1 && getline('$') == '') || filereadable('%')
		return
	endif

	" Load UltiSnips in case it was deferred via vim-plug
	if !exists('g:did_plugin_ultisnips') && exists(':PlugStatus')
		call plug#load('ultisnips')
		doautocmd FileType
	endif

	" the function feedkys simulates the insert key sequence in order to call
	" the template (skel)
	execute 'call feedkeys("i_skel\<C-r>=UltiSnips#ExpandSnippet()\<CR>")'
endfunction
" remember to create a _skel snippet with your header for each file you
" want a autosnippet 

augroup ultisnips_custom
autocmd!
au Bufnewfile *.sh,*.zsh,*.html,*.css,*.py,*.tex,*.txt,*.md,*.vim :call TestAndLoadSkel()
augroup END

" vim: fdm=marker:sw=2:sts=2:et

